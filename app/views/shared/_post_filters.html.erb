<% @category = Category.find_by(id: params[:cat]) %>

<div class="col-md-8">
  <form action="<%= base_path %>"
        class="form-inline d-flex navbar-left align-items-center mb-2"
        method="get"
        role="search">
    <%= hidden_field_tag(:org, params[:org]) if params[:org].present? %>
    <div class="d-flex h-100">
      <input class="form-control w-auto"
              name="q"
              placeholder="<%= t("global.search") %>"
              type="text"
              value="<%= params[:q] %>">
      <button class="btn btn-secondary ms-1" type="submit">
        <%= t("global.search") %>
      </button>
    </div>
    <ul class="nav navbar-nav d-none d-sm-flex">
      <li class="dropdown nav-item">
        <a class="dropdown-toggle nav-link text-primary" href="#" data-bs-toggle="dropdown" role="button" aria-expanded="false">
          <%= @category ? @category.name : Category.model_name.human %>
        </a>
        <ul class="dropdown-menu" role="menu">
          <li>
            <%= link_to "Ã— #{t('global.all')}", base_path, class: "dropdown-item" %>
          </li>
          <% all_categories.each do |c| %>
            <% next if c == @category %>
            <li>
              <%= link_to "#{base_path}?cat=#{c.id}", class: "dropdown-item" do %>
                <%= category_icon(c) %>
                <%= c.name %>
              <% end %>
            </li>
          <% end %>
        </ul>
      </li>
    </ul>
  </form>
</div>
